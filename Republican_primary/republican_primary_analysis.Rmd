---
title: "republican_primary_analysis"
output: html_document
---

```{r setup, include=FALSE}
## loading libraries
library(tidyverse)
library(tidycensus)
library(janitor)

## loading in data
schulz_data <- read_csv("data/Schulz_ContributionsList.csv")
cox_data <- read_csv("data/Cox_ContributionsList.csv")
Trump_1 <- read_csv("data/Trump_1.csv")
Trump_2 <- read_csv("data/Trump_2.csv")
Trump_3 <- read_csv("data/Trump_3.csv")
Hogan_data <- read_csv("data/Hogan_ContributionsList.csv")

## cleaning data
schulz_data <- schulz_data %>%
  mutate(`Receiving Committee` = "Schulz") %>%
  mutate(zip = str_extract(`Contributor Address`, "\\d{5}")) %>%
  mutate(zip = as.numeric(zip))

cox_data <- cox_data %>%
  mutate(`Receiving Committee` = "Cox") %>%
  mutate(zip = str_extract(`Contributor Address`, "\\d{5}")) %>%
  mutate(zip= as.numeric(zip))

Hogan_data <- Hogan_data %>%
  mutate(`Receiving Committee` = "Hogan") %>%
  mutate(zip = str_extract(`Contributor Address`, "\\d{5}")) %>%
  mutate(zip = as.numeric(zip))

Trump_1 <- Trump_1 %>%
  select(transaction_id, contributor_name, contributor_street_1, contributor_zip, contribution_receipt_date, contribution_receipt_amount)

Trump_2 <- Trump_2 %>%
  select(transaction_id, contributor_name, contributor_street_1, contributor_zip, contribution_receipt_date, contribution_receipt_amount)

Trump_3 <- Trump_3 %>%
  select(transaction_id, contributor_name, contributor_street_1, contributor_zip, contribution_receipt_date, contribution_receipt_amount)

## need to make the zips in two of the datasets numeric to join

Trump_1 <- Trump_1 %>%
  mutate(contributor_zip = as.numeric(contributor_zip))

Trump_2 <- Trump_2 %>%
  mutate(contributor_zip = as.numeric(contributor_zip))

## combining Trump data into one dataset
Trump_master <- bind_rows(Trump_1, Trump_2, Trump_3)

## cleaning Trump master dataset
Trump_master <- Trump_master %>%
  mutate(contributor_zip = str_sub(contributor_zip, 1, 5)) %>%
  mutate(contributor_name = str_to_title(contributor_name)) %>%
  mutate(contributor_street_1 = str_to_title(contributor_street_1)) %>%
  mutate(contributor_name = str_replace_all(contributor_name, ",", " "))

## finding unique name of Trump donors to match with the Schulz and Cox datasets 
Hogan_unique <- Hogan_data %>%
  select(`Contributor Name`, zip) %>%
  unique()

Trump_unique <- Trump_master %>%
  select(contributor_name, contributor_zip) %>%
  unique()

Cox_unique <- cox_data %>%
  select(`Contributor Name`, zip) %>%
  unique()

Schulz_unique <- schulz_data %>%
  select(`Contributor Name`, zip) %>%
  unique()

## joining Cox and Schulz unique donors with Trump unique donors
Cox_Trump_Unique <- Trump_unique %>%
  inner_join(Cox_unique, by=c("contributor_name"="Contributor Name"))

Schulz_Trump_Unique <- Trump_unique %>%
  inner_join(Schulz_unique, by=c("contributor_name"="Contributor Name"))

## joining the isolated dataset of donors that donated to both Trump and these two candidates to the two candidates' datasets

Cox_Trump_donors <- cox_data %>%
  inner_join(Cox_Trump_Unique, by=c("Contributor Name"="contributor_name"))

Schulz_Trump_donors <- schulz_data %>%
  inner_join(Schulz_Trump_Unique, by=c("Contributor Name"="contributor_name"))

## how much did the candidates raise from Trump donors?
Cox_Trump_donors %>%
  summarise(total = sum(`Contribution Amount`))

cox_data %>%
  summarise(total = sum(`Contribution Amount`))
122513.7/397167.3
## Cox raised $122513.7 from Trump donors, which is .3084687 of Cox's money

Schulz_Trump_donors %>%
  summarise(total = sum(`Contribution Amount`))

schulz_data %>%
  summarise(total = sum(`Contribution Amount`))
87337/1522000
## Schulz raised $87,337 from Trump donors, which is just .05738305 of Schulz's money

## joining Cox/Trump donors with Hogan donors to see the crossover
Cox_Hogan_unique <- Cox_Trump_Unique %>%
  inner_join(Hogan_unique, by=c("contributor_name"="Contributor Name"))

Cox_Hogan_joined <- cox_data %>%
  inner_join(Cox_Hogan_unique, by=c("Contributor Name"="contributor_name"))
```
